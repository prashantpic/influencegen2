<odoo>
    <data>
        <template id="portal_ai_image_generator_page" name="AI Image Generator">
            <t t-call="portal.portal_layout">
                <t t-set="breadcrumbs" t-value="[
                    {'url': '/my/dashboard', 'text': _t('Dashboard')},
                    {'url': '/my/ai-image-generator', 'text': _t('AI Image Generator')}
                ]"/>
                 <t t-call="portal.portal_search_panel">
                     <t t-set="title">
                        <h1 class="mb-0"><t t-esc="_t('AI Image Generator')"/></h1>
                    </t>
                </t>

                <div class="container mt-4">
                    <div class="row">
                        <div class="col-12">
                            <div class="alert alert-info d-flex justify-content-between align-items-center" role="alert">
                                <div>
                                    <i class="fa fa-info-circle me-2"/>
                                    <t t-esc="_t('Use your creativity to generate unique images for your content. Your usage is subject to a quota.')"/>
                                </div>
                                <div t-if="current_quota" class="fw-bold">
                                    <t t-esc="_t('Quota: %s / %s remaining', current_quota.remaining, current_quota.total)"/>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Placeholder for OWL AIImageGeneratorComponent -->
                    <div id="ai-image-generator-app" class="mt-3">
                        <!-- This div will be targeted by JavaScript to mount the OWL component. -->
                        <div class="text-center p-5">
                            <div class="spinner-border text-primary" role="status">
                                <span class="visually-hidden"><t t-esc="_t('Loading AI Image Generator...')"/></span>
                            </div>
                            <p class="mt-2"><t t-esc="_t('Loading AI Image Generator...')"/></p>
                        </div>
                    </div>
                </div>

                <script type="text/javascript">
                    odoo.loader. όταν hazırsa(function () {
                        const { mount } = owl;
                        const target = document.getElementById('ai-image-generator-app');
                        
                        // Check if odoo.influence_gen_portal.components.AIImageGeneratorComponent is available
                        // This relies on the assets being loaded and the component registered correctly.
                        if (target &amp;&amp; odoo &amp;&amp; odoo.influence_gen_portal &amp;&amp; odoo.influence_gen_portal.components &amp;&amp; odoo.influence_gen_portal.components.AIImageGeneratorComponent) {
                            const AIImageGeneratorComponent = odoo.influence_gen_portal.components.AIImageGeneratorComponent;
                            const initialQuota = <t t-esc="json.dumps(current_quota or {'used': 0, 'total': 0})"/>;
                            const defaultParams = <t t-esc="json.dumps(default_params or {})"/>;
                            const paramRanges = <t t-esc="json.dumps(param_ranges or {})"/>;

                            mount(AIImageGeneratorComponent, target, {
                                props: {
                                    initialQuota: initialQuota,
                                    defaultParams: defaultParams,
                                    paramRanges: paramRanges,
                                }
                            });
                        } else {
                            if (target) {
                                target.innerHTML = `&lt;div class="alert alert-danger" role="alert"&gt;<t t-esc="_t('Error: Could not load the AI Image Generator component. Please try refreshing the page or contact support.')"/>&lt;/div&gt;`;
                            }
                            console.error("AIImageGeneratorComponent not found or target element missing.");
                        }
                    });
                </script>
            </t>
        </template>
    </data>
</odoo>