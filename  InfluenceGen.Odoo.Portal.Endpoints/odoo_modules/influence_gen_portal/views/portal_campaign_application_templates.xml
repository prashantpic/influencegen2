<odoo>
    <data>
        <template id="portal_campaign_application_form" name="Campaign Application Form">
            <t t-call="portal.portal_layout">
                <t t-set="breadcrumbs" t-value="[
                    {'url': '/my/dashboard', 'text': _t('Dashboard')},
                    {'url': '/my/campaigns', 'text': _t('Campaigns')},
                    {'url': campaign.get_portal_url(), 'text': campaign.name},
                    {'url': '#', 'text': _t('Apply')}
                ]"/>
                 <t t-call="portal.portal_search_panel">
                     <t t-set="title">
                        <h1 class="mb-0"><t t-esc="_t('Apply for: %s', campaign.name)"/></h1>
                    </t>
                </t>

                <div class="container mt-4">
                     <div t-if="error_message" class="alert alert-danger" role="alert">
                        <t t-esc="error_message"/>
                    </div>
                     <div t-if="success_message" class="alert alert-success" role="alert">
                        <t t-esc="success_message"/>
                    </div>

                    <div class="card shadow-sm">
                        <div class="card-header bg-light">
                            <h4 class="mb-0"><t t-esc="_t('Confirm Campaign Requirements')"/></h4>
                        </div>
                        <div class="card-body">
                            <p><strong><t t-esc="_t('Campaign:')"/></strong> <t t-esc="campaign.name"/></p>
                            <p><strong><t t-esc="_t('Brand:')"/></strong> <t t-esc="campaign.brandClient"/></p>

                            <div class="mb-3 p-3 border rounded bg-light">
                                <h5><t t-esc="_t('Key Requirements Summary:')"/></h5>
                                <div t-out="campaign.contentRequirements_summary or campaign.contentRequirements[:250] + '...'"/>
                                <p class="mt-2"><strong><t t-esc="_t('Submission Deadline:')"/></strong> <span t-field="campaign.submissionDeadline" t-options='{"widget": "date"}'/></p>
                            </div>

                            <form t-attf-action="/my/campaigns/#{campaign.id}/apply/process" method="post">
                                <input type="hidden" name="csrf_token" t-att-value="request.csrf_token()"/>

                                <div t-if="campaign.requires_proposal" class="mb-3">
                                    <label for="proposal" class="form-label"><h5><t t-esc="_t('Your Proposal/Pitch')"/></h5></label>
                                    <textarea class="form-control" id="proposal" name="proposal" rows="5" t-att-required="campaign.requires_proposal and 'required'" placeholder="Explain why you're a good fit for this campaign and outline your content ideas..."></textarea>
                                </div>

                                <t t-if="campaign.application_questions">
                                    <h5><t t-esc="_t('Campaign Specific Questions')"/></h5>
                                    <t t-foreach="campaign.application_questions" t-as="question">
                                        <div class="mb-3">
                                            <label t-attf-for="question_#{question.id}" class="form-label"><t t-esc="question.text"/></label>
                                            <t t-if="question.type == 'text'">
                                                <input type="text" class="form-control" t-attf-id="question_#{question.id}" t-attf-name="question_#{question.id}" t-att-required="question.is_required and 'required'"/>
                                            </t>
                                            <t t-if="question.type == 'textarea'">
                                                 <textarea class="form-control" t-attf-id="question_#{question.id}" t-attf-name="question_#{question.id}" rows="3" t-att-required="question.is_required and 'required'"></textarea>
                                            </t>
                                            <!-- Add other question types if needed -->
                                        </div>
                                    </t>
                                </t>

                                <div class="form-check mb-3">
                                    <input class="form-check-input" type="checkbox" value="true" id="confirm_requirements" name="confirm_requirements" required="required"/>
                                    <label class="form-check-label" for="confirm_requirements">
                                        <t t-esc="_t('I have read, understood, and agree to all campaign requirements, content guidelines, submission deadlines, and usage rights as detailed in the campaign description.')"/>
                                    </label>
                                </div>
                                <button type="submit" class="btn btn-success btn-lg"><i class="fa fa-paper-plane me-1"/> <t t-esc="_t('Submit Application')"/></button>
                            </form>
                        </div>
                    </div>
                    <div class="mt-3">
                        <a t-attf-href="/my/campaigns/#{campaign.id}" class="btn btn-secondary"><i class="fa fa-arrow-left me-1"/> <t t-esc="_t('Back to Campaign Details')"/></a>
                    </div>
                </div>
            </t>
        </template>
    </data>
</odoo>